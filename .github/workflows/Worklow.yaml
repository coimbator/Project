name: GitHub Actions Test
run-name: ${{ github.actor }} workflow test
on: [push]

jobs:
  azureLogin:
    runs-on: ubuntu-latest
    steps:
      # Azure login step
      - name: Log in to Azure
        uses: azure/login@v1
        with:
          creds: '${{ secrets.AZURE_CREDENTIALS }}'

  uploadDataset:
    needs: azureLogin
    runs-on: ubuntu-latest
    steps:
      # Set up Azure ML extension
      - name: Install Azure ML extension
        run: |
          az extension add -n ml -y
          az extension update -n ml

      # Upload dataset to Azure ML
      - name: Upload dataset to Azure ML
        run: |
          az ml data create --name HAR1 \
            --path HAR.csv \
            --type uri_file \
            --workspace-name Project-WS \
            --resource-group Project-G \
            --description "Dataset uploaded via GitHub Actions"
  amlJobSubmission:
    needs: azureLogin
    runs-on: ubuntu-latest
    steps:
      # Submit the Azure ML job
      - name: Submit Azure ML job
        run: az ml job create --file job.yml --web --resource-group Project-G --workspace-name Project-WS
